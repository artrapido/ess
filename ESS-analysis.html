<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sergey Polyarus">

<title>ESS-analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="ESS-analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="ESS-analysis_files/libs/quarto-html/quarto.js"></script>
<script src="ESS-analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="ESS-analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="ESS-analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="ESS-analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ESS-analysis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ESS-analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ESS-analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ESS-analysis_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ESS-analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sergey Polyarus </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data">Data</h2>
<p>The dataset provides for information on politically related surveys conducted in Europe periodically since the year 2001. It contains information about both political issues and personal data of the respondents. Variables’ transcript may be found at https://www.europeansocialsurvey.org/</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pycountry <span class="im">as</span> py</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pycountry_convert <span class="im">as</span> pyco</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> nan</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"data.csv"</span>, na_filter<span class="op">=</span><span class="va">False</span>, low_memory<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="what-is-the-ranking-of-european-countries-with-respect-to-of-average-satisfaction-with-life" class="level2">
<h2 class="anchored" data-anchor-id="what-is-the-ranking-of-european-countries-with-respect-to-of-average-satisfaction-with-life">What is the ranking of European countries with respect to of average satisfaction with life?</h2>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df.cntry.replace(to_replace<span class="op">=</span><span class="st">'XK'</span>, value <span class="op">=</span> <span class="st">'RS'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.assign(Year <span class="op">=</span> <span class="dv">2002</span><span class="op">+</span>(df.essround<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Country'</span>] <span class="op">=</span> df[<span class="st">'cntry'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: pyco.country_alpha2_to_country_name(x))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>stflifedata <span class="op">=</span> df.loc[df[<span class="st">'stflife'</span>]<span class="op">&lt;</span><span class="dv">11</span>]</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>stflifedata <span class="op">=</span> stflifedata.groupby([<span class="st">'Country'</span>,<span class="st">'Year'</span>])[<span class="st">'stflife'</span>].mean().reset_index()</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>stflifedata <span class="op">=</span> stflifedata.pivot(index<span class="op">=</span><span class="st">'Country'</span>,columns<span class="op">=</span><span class="st">'Year'</span>,values<span class="op">=</span><span class="st">'stflife'</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>stflifedata <span class="op">=</span> stflifedata.sort_values(by<span class="op">=</span>[<span class="dv">2018</span>],ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>stflifedata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>Year</th>
      <th>2006</th>
      <th>2012</th>
      <th>2018</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Denmark</th>
      <td>8.476286</td>
      <td>8.570995</td>
      <td>8.500958</td>
    </tr>
    <tr>
      <th>Iceland</th>
      <td>NaN</td>
      <td>7.961230</td>
      <td>8.153667</td>
    </tr>
    <tr>
      <th>Switzerland</th>
      <td>8.031059</td>
      <td>8.193159</td>
      <td>8.150747</td>
    </tr>
    <tr>
      <th>Finland</th>
      <td>7.987850</td>
      <td>8.111668</td>
      <td>8.040502</td>
    </tr>
    <tr>
      <th>Sweden</th>
      <td>7.824844</td>
      <td>7.870933</td>
      <td>7.937459</td>
    </tr>
    <tr>
      <th>Netherlands</th>
      <td>7.481187</td>
      <td>7.770732</td>
      <td>7.900179</td>
    </tr>
    <tr>
      <th>Norway</th>
      <td>7.761741</td>
      <td>8.138718</td>
      <td>7.858974</td>
    </tr>
    <tr>
      <th>Austria</th>
      <td>7.533781</td>
      <td>NaN</td>
      <td>7.853307</td>
    </tr>
    <tr>
      <th>Germany</th>
      <td>6.713942</td>
      <td>7.481394</td>
      <td>7.664116</td>
    </tr>
    <tr>
      <th>Belgium</th>
      <td>7.408914</td>
      <td>7.435760</td>
      <td>7.526644</td>
    </tr>
    <tr>
      <th>Spain</th>
      <td>7.442060</td>
      <td>6.897558</td>
      <td>7.423586</td>
    </tr>
    <tr>
      <th>Slovenia</th>
      <td>6.972789</td>
      <td>6.976856</td>
      <td>7.329528</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <td>7.126413</td>
      <td>7.279982</td>
      <td>7.243071</td>
    </tr>
    <tr>
      <th>Ireland</th>
      <td>7.481564</td>
      <td>6.722689</td>
      <td>7.235535</td>
    </tr>
    <tr>
      <th>Montenegro</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.214945</td>
    </tr>
    <tr>
      <th>Poland</th>
      <td>6.671921</td>
      <td>7.099099</td>
      <td>7.043243</td>
    </tr>
    <tr>
      <th>Czechia</th>
      <td>NaN</td>
      <td>6.538656</td>
      <td>7.023889</td>
    </tr>
    <tr>
      <th>Estonia</th>
      <td>6.378342</td>
      <td>6.177834</td>
      <td>7.022070</td>
    </tr>
    <tr>
      <th>Cyprus</th>
      <td>7.412060</td>
      <td>6.900901</td>
      <td>7.019305</td>
    </tr>
    <tr>
      <th>Croatia</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.957848</td>
    </tr>
    <tr>
      <th>Italy</th>
      <td>NaN</td>
      <td>6.677215</td>
      <td>6.894174</td>
    </tr>
    <tr>
      <th>Portugal</th>
      <td>5.458964</td>
      <td>5.957397</td>
      <td>6.551429</td>
    </tr>
    <tr>
      <th>Latvia</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.535597</td>
    </tr>
    <tr>
      <th>France</th>
      <td>6.315206</td>
      <td>6.400610</td>
      <td>6.470971</td>
    </tr>
    <tr>
      <th>Lithuania</th>
      <td>NaN</td>
      <td>5.819664</td>
      <td>6.227048</td>
    </tr>
    <tr>
      <th>Slovakia</th>
      <td>6.084096</td>
      <td>6.551799</td>
      <td>6.136067</td>
    </tr>
    <tr>
      <th>Hungary</th>
      <td>5.313830</td>
      <td>5.592184</td>
      <td>6.101458</td>
    </tr>
    <tr>
      <th>Serbia</th>
      <td>NaN</td>
      <td>6.053167</td>
      <td>5.915347</td>
    </tr>
    <tr>
      <th>Bulgaria</th>
      <td>4.659467</td>
      <td>4.338968</td>
      <td>4.920387</td>
    </tr>
    <tr>
      <th>Albania</th>
      <td>NaN</td>
      <td>5.752715</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Israel</th>
      <td>NaN</td>
      <td>7.530358</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Russian Federation</th>
      <td>5.190988</td>
      <td>5.786412</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Ukraine</th>
      <td>4.281059</td>
      <td>5.043703</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>The table shows rather evident things: West and North Europe feel better, then comes Central and South Europe, and the worst numbers correspond with former Warsaw Pact countries. Remarkable observations here are Spain (too high for South Europe), the UK (too low for West Europe country - and too close to Ireland which is way less developed), France (too low for this level of development).</p>
</section>
<section id="a-visualization-where-you-first-count-the-number-of-individuals-each-combination-of-valid-values-of-atchctr-and-atcherp" class="level2">
<h2 class="anchored" data-anchor-id="a-visualization-where-you-first-count-the-number-of-individuals-each-combination-of-valid-values-of-atchctr-and-atcherp">A visualization where you first count the number of individuals each combination of valid values of atchctr and atcherp</h2>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df.atchctr<span class="op">=</span>df.atchctr.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">99</span> <span class="cf">if</span> ((x<span class="op">==</span><span class="st">''</span>) <span class="op">|</span> (pd.isna(x))) <span class="cf">else</span> <span class="bu">int</span>(x))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df.atcherp<span class="op">=</span>df.atcherp.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">99</span> <span class="cf">if</span> ((x<span class="op">==</span><span class="st">''</span>) <span class="op">|</span> (pd.isna(x))) <span class="cf">else</span> <span class="bu">int</span>(x))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>dfattach <span class="op">=</span> df.loc[(df[<span class="st">'atchctr'</span>]<span class="op">&lt;</span><span class="dv">11</span>)<span class="op">&amp;</span>(df[<span class="st">'atcherp'</span>]<span class="op">&lt;</span><span class="dv">11</span>)]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>valuetable <span class="op">=</span> pd.crosstab(df[<span class="st">'atchctr'</span>],df[<span class="st">'atcherp'</span>]).reset_index()[[<span class="st">'atchctr'</span>,  <span class="fl">0.0</span>,  <span class="fl">1.0</span>,  <span class="fl">2.0</span>,  <span class="fl">3.0</span>,  <span class="fl">4.0</span>, <span class="fl">5.0</span>,  <span class="fl">6.0</span>,  <span class="fl">7.0</span>,  <span class="fl">8.0</span>,  <span class="fl">9.0</span>, <span class="fl">10.0</span>]].loc[<span class="dv">0</span>:<span class="dv">10</span>]</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>pd.crosstab(dfattach[<span class="st">'atchctr'</span>],dfattach[<span class="st">'atcherp'</span>])</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>dfattach <span class="op">=</span> df.loc[(df[<span class="st">'atchctr'</span>]<span class="op">&lt;</span><span class="dv">11</span>)<span class="op">&amp;</span>(df[<span class="st">'atcherp'</span>]<span class="op">&lt;</span><span class="dv">11</span>)]</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>valuetablelong <span class="op">=</span>dfattach[[<span class="st">'atchctr'</span>,<span class="st">'atcherp'</span>]].value_counts().reset_index()</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>dfattach <span class="op">=</span> df.loc[(df[<span class="st">'atchctr'</span>]<span class="op">&lt;</span><span class="dv">11</span>)<span class="op">&amp;</span>(df[<span class="st">'atcherp'</span>]<span class="op">&lt;</span><span class="dv">11</span>)]</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>valuetablelong <span class="op">=</span>dfattach[[<span class="st">'atchctr'</span>,<span class="st">'atcherp'</span>]].value_counts().reset_index()</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>valuetablelong <span class="op">=</span> valuetablelong.rename(columns<span class="op">=</span>{<span class="dv">0</span>:<span class="st">'NumIndividuals'</span>})</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>valuetablelong,x<span class="op">=</span><span class="st">'atchctr'</span>,y<span class="op">=</span><span class="st">'atcherp'</span>,size<span class="op">=</span><span class="st">'NumIndividuals'</span>,hue<span class="op">=</span><span class="st">'NumIndividuals'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x27802413250&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ESS-analysis_files/figure-html/cell-4-output-2.png" width="578" height="470"></p>
</div>
</div>
<p>As we can see, the only superior combination in terms of its frequency is (10, 10), and overall the most frequent result is coincidence of high values of both variables. .</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>sns.regplot(x<span class="op">=</span>dfattach[<span class="st">'atchctr'</span>], y <span class="op">=</span> dfattach[<span class="st">'atcherp'</span>], lowess <span class="op">=</span> <span class="va">True</span>, scatter<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="ESS-analysis_files/figure-html/cell-5-output-1.png" width="576" height="429"></p>
</div>
</div>
<p>The line differs from y=x, but in general positive correlation between national attachment and european attachment is clear. The more average European is attached to his country, the more he is usually attached to Europe in general. In such a way, being attached to a country does not contradict being attached to the entire continent.This might display presence of a common European identity.</p>
<p>The same lines for different states look like:</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.FacetGrid(dfattach, col<span class="op">=</span><span class="st">"Country"</span>, col_wrap<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>g.map_dataframe(sns.regplot,y<span class="op">=</span><span class="st">'atcherp'</span>,x<span class="op">=</span><span class="st">'atchctr'</span>,scatter<span class="op">=</span><span class="va">False</span>,lowess<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="ESS-analysis_files/figure-html/cell-6-output-1.png" width="1426" height="1718"></p>
</div>
</div>
<p>Here we may observe the contrast in this correlation among different countries. The interesting thing we cannot even grasp a tendency of West block vs.&nbsp;East block, North vs.&nbsp;South, Large vs Small etc. It is all very individual.</p>
</section>
<section id="what-is-the-relation-of-the-emotional-attachment-to-the-own-country-and-the-opinion-about-further-of-european-unification" class="level2">
<h2 class="anchored" data-anchor-id="what-is-the-relation-of-the-emotional-attachment-to-the-own-country-and-the-opinion-about-further-of-european-unification">What is the relation of the emotional attachment to the own country and the opinion about further of European unification?</h2>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dfatceuf<span class="op">=</span>df[(df[<span class="st">'atchctr'</span>]<span class="op">&lt;</span><span class="dv">11</span>)<span class="op">&amp;</span>(df[<span class="st">'euftf'</span>]<span class="op">&lt;</span><span class="dv">11</span>)]</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>sns.regplot(data<span class="op">=</span>dfatceuf, x<span class="op">=</span><span class="st">'atchctr'</span>, y <span class="op">=</span> <span class="st">'euftf'</span>, lowess <span class="op">=</span> <span class="va">True</span>, scatter<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="ESS-analysis_files/figure-html/cell-7-output-1.png" width="589" height="429"></p>
</div>
</div>
<p>The euftf column is about attitude to European unification, where 0 is “Unification already gone too far” and 10 is “Unification go further”. So break 5 of the scale may be regarded as a watershed between positive and negative attitude to further European unification. Indeed, we may observe that between the euftf’s 5.0 and 5.5 breaks the atchctr begins to decrease noticeably. In other words, after a man becomes more pro-unificationist, his attachment to the country is likely to decline. Unlike the variables from the previous question, these two variables may actually be chosen as juxtaposition indicators of “the national” and “the European” in the respondent’s views.</p>
</section>
<section id="how-many-observations-are-there-for-each-country-year-combination" class="level2">
<h2 class="anchored" data-anchor-id="how-many-observations-are-there-for-each-country-year-combination">How many observations are there for each country-year combination?</h2>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>valuedf <span class="op">=</span> df[[<span class="st">'Year'</span>, <span class="st">'Country'</span>]].value_counts().reset_index()</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>valuedf <span class="op">=</span> valuedf.rename(columns<span class="op">=</span>{<span class="dv">0</span>:<span class="st">"NumCombinations"</span>})</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>valuedf <span class="op">=</span> valuedf.pivot(index <span class="op">=</span> <span class="st">"Country"</span>, values <span class="op">=</span> <span class="st">"NumCombinations"</span>, columns <span class="op">=</span> <span class="st">"Year"</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>valuedf <span class="op">=</span> valuedf.reset_index()</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>valuedf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>Year</th>
      <th>Country</th>
      <th>2006</th>
      <th>2012</th>
      <th>2018</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Albania</td>
      <td>NaN</td>
      <td>1201.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Austria</td>
      <td>2405.0</td>
      <td>NaN</td>
      <td>2499.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Belgium</td>
      <td>1798.0</td>
      <td>1869.0</td>
      <td>1767.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Bulgaria</td>
      <td>1400.0</td>
      <td>2260.0</td>
      <td>2198.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Croatia</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1810.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Cyprus</td>
      <td>995.0</td>
      <td>1116.0</td>
      <td>781.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Czechia</td>
      <td>NaN</td>
      <td>2009.0</td>
      <td>2398.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Denmark</td>
      <td>1505.0</td>
      <td>1650.0</td>
      <td>1572.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Estonia</td>
      <td>1517.0</td>
      <td>2380.0</td>
      <td>1904.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Finland</td>
      <td>1896.0</td>
      <td>2197.0</td>
      <td>1755.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>France</td>
      <td>1986.0</td>
      <td>1968.0</td>
      <td>2010.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Germany</td>
      <td>2916.0</td>
      <td>2958.0</td>
      <td>2358.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Hungary</td>
      <td>1518.0</td>
      <td>2014.0</td>
      <td>1661.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Iceland</td>
      <td>NaN</td>
      <td>752.0</td>
      <td>861.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Ireland</td>
      <td>1800.0</td>
      <td>2628.0</td>
      <td>2216.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Israel</td>
      <td>NaN</td>
      <td>2508.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Italy</td>
      <td>NaN</td>
      <td>960.0</td>
      <td>2745.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Latvia</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>918.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Lithuania</td>
      <td>NaN</td>
      <td>2109.0</td>
      <td>1835.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Montenegro</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1200.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Netherlands</td>
      <td>1889.0</td>
      <td>1845.0</td>
      <td>1673.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Norway</td>
      <td>1750.0</td>
      <td>1624.0</td>
      <td>1406.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Poland</td>
      <td>1721.0</td>
      <td>1898.0</td>
      <td>1500.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Portugal</td>
      <td>2222.0</td>
      <td>2151.0</td>
      <td>1055.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Russian Federation</td>
      <td>2437.0</td>
      <td>2484.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Serbia</td>
      <td>NaN</td>
      <td>1295.0</td>
      <td>2043.0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Slovakia</td>
      <td>1766.0</td>
      <td>1847.0</td>
      <td>1083.0</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Slovenia</td>
      <td>1476.0</td>
      <td>1257.0</td>
      <td>1318.0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Spain</td>
      <td>1876.0</td>
      <td>1889.0</td>
      <td>1668.0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Sweden</td>
      <td>1927.0</td>
      <td>1847.0</td>
      <td>1539.0</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Switzerland</td>
      <td>1804.0</td>
      <td>1493.0</td>
      <td>1542.0</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Ukraine</td>
      <td>2002.0</td>
      <td>2178.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>32</th>
      <td>United Kingdom</td>
      <td>2394.0</td>
      <td>2286.0</td>
      <td>2204.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>No, the numbers are not proportional to the population, e.g.&nbsp;roughly the same number of respondents is presented for majority of countries regardless of their population size. The only shortcoming for qq. 2 and 3 is that the data collected for large countries (like Germany) is less representative than the data collected for smaller countries like Latvia. Since we cannot assume that the data is representative for large countries, we should note that attitude of the European people to integration may be different (as a large amount of European population is presented in the survey equally with lesser parts of it). In other words, opinion of smaller countries’ population may be overvalued.</p>
</section>
<section id="what-is-the-correlation-between-attitude-to-the-european-unification-and-left-right-political-scale-position-the-lrscale-variable.-the-lrscale-is-designed-as-following-0-is-extremely-left-and-10-is-extremely-right." class="level2">
<h2 class="anchored" data-anchor-id="what-is-the-correlation-between-attitude-to-the-european-unification-and-left-right-political-scale-position-the-lrscale-variable.-the-lrscale-is-designed-as-following-0-is-extremely-left-and-10-is-extremely-right.">What is the correlation between attitude to the European unification and left-right political scale position (the lrscale variable). The lrscale is designed as following: 0 is extremely left and 10 is extremely right.</h2>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>dflrsc <span class="op">=</span> df[(df.lrscale<span class="op">&lt;</span><span class="dv">11</span>)<span class="op">&amp;</span>(df[<span class="st">'euftf'</span>]<span class="op">&lt;</span><span class="dv">11</span>)]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> sns.regplot(data<span class="op">=</span>dflrsc, x<span class="op">=</span><span class="st">'lrscale'</span>, y <span class="op">=</span> <span class="st">'euftf'</span>, lowess <span class="op">=</span> <span class="va">True</span>, scatter<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>graph.axes.set_xlim(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>graph</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>&lt;AxesSubplot:xlabel='lrscale', ylabel='euftf'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ESS-analysis_files/figure-html/cell-9-output-2.png" width="597" height="429"></p>
</div>
</div>
<p>The graph is showing that the left and the right are not opposing each other in terms of European unification as hard as we tend to think. The negative correlation (the righter - the more anti-unification) is seen below the 6 break of lrscale only, and then the graph changes its diretion. In such a way, the extreme right and the extreme left are more likely to share common view on necessity of further European unification than any of them and a centrist.</p>
</section>
<section id="what-are-the-correlations-between-life-satisfaction-trust-in-the-police-religiosity-emotional-attachment-to-europe-and-social-activity" class="level2">
<h2 class="anchored" data-anchor-id="what-are-the-correlations-between-life-satisfaction-trust-in-the-police-religiosity-emotional-attachment-to-europe-and-social-activity">What are the correlations between life satisfaction, trust in the police, religiosity, emotional attachment to Europe, and social activity?</h2>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>dfqsix <span class="op">=</span> df.loc[df[<span class="st">'essround'</span>]<span class="op">==</span><span class="dv">9</span>] </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>dfqsix <span class="op">=</span>  dfqsix[[<span class="st">'stflife'</span>, <span class="st">'trstplc'</span>, <span class="st">'rlgdgr'</span>, <span class="st">'atcherp'</span>, <span class="st">'sclact'</span>]]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>dfqsix.corr()</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>sns.heatmap(dfqsix.corr(), center <span class="op">=</span> <span class="fl">0.6</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="ESS-analysis_files/figure-html/cell-10-output-1.png" width="533" height="416"></p>
</div>
</div>
<p>Here we observe that each point of life satisfaction adds to trust to police more than to other variables. In my opinion, this happens because while assessing satisfaction of life people implicitly give feedback to the state that organizes this very life, i. e. state authorities and their activities mean a lot to rate life satisfaction. Police is one of the most important state authorities, that is why these two variables correlate. Then comes correlation between social activities and life satisfaction. I assume this may be explained by the fact that social activities let people fulfill their communication capability and make them more satisfied. The least correlated pairs are social activity rate and police trust rate (this seems to be not only correlation issue but an issue of actual absence of a link) and the being religious rate and social activity rate (this seems stranger since religions usually encourage conciliarity).</p>
</section>
<section id="which-variables-can-explain-the-variance-of-life-satisfaction-in-a-linear-model-how-well" class="level2">
<h2 class="anchored" data-anchor-id="which-variables-can-explain-the-variance-of-life-satisfaction-in-a-linear-model-how-well">Which variables can explain the variance of life satisfaction in a linear model how well?</h2>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>dfqsev <span class="op">=</span> dfqsix</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> dfqsev.columns</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>dfqsev[cols] <span class="op">=</span> dfqsev[cols].<span class="bu">apply</span>(pd.to_numeric)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> smf.ols(<span class="st">'stflife ~ trstplc + rlgdgr + atcherp + sclact'</span>, data<span class="op">=</span>dfqsev).fit()</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>results.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">

<table class="simpletable">
<caption>OLS Regression Results</caption>
<tbody><tr>
  <th>Dep. Variable:</th>         <td>stflife</td>     <th>  R-squared:         </th>  <td>   0.026</td>  
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th>  <td>   0.026</td>  
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th>  <td>   328.3</td>  
</tr>
<tr>
  <th>Date:</th>             <td>Wed, 18 Jan 2023</td> <th>  Prob (F-statistic):</th>  <td>2.34e-279</td> 
</tr>
<tr>
  <th>Time:</th>                 <td>23:23:02</td>     <th>  Log-Likelihood:    </th> <td>-1.5886e+05</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td> 49519</td>      <th>  AIC:               </th>  <td>3.177e+05</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td> 49514</td>      <th>  BIC:               </th>  <td>3.178e+05</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>     4</td>      <th>                     </th>      <td> </td>     
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>      <td> </td>     
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P&gt;|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>    5.5384</td> <td>    0.076</td> <td>   72.616</td> <td> 0.000</td> <td>    5.389</td> <td>    5.688</td>
</tr>
<tr>
  <th>trstplc</th>   <td>    0.0982</td> <td>    0.004</td> <td>   26.381</td> <td> 0.000</td> <td>    0.091</td> <td>    0.106</td>
</tr>
<tr>
  <th>rlgdgr</th>    <td>    0.0402</td> <td>    0.003</td> <td>   12.757</td> <td> 0.000</td> <td>    0.034</td> <td>    0.046</td>
</tr>
<tr>
  <th>atcherp</th>   <td>    0.0165</td> <td>    0.002</td> <td>    7.159</td> <td> 0.000</td> <td>    0.012</td> <td>    0.021</td>
</tr>
<tr>
  <th>sclact</th>    <td>    0.3411</td> <td>    0.024</td> <td>   14.487</td> <td> 0.000</td> <td>    0.295</td> <td>    0.387</td>
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
  <th>Omnibus:</th>       <td>79560.425</td> <th>  Durbin-Watson:     </th>   <td>   1.977</td>  
</tr>
<tr>
  <th>Prob(Omnibus):</th>  <td> 0.000</td>   <th>  Jarque-Bera (JB):  </th> <td>39985594.799</td>
</tr>
<tr>
  <th>Skew:</th>           <td>10.782</td>   <th>  Prob(JB):          </th>   <td>    0.00</td>  
</tr>
<tr>
  <th>Kurtosis:</th>       <td>140.530</td>  <th>  Cond. No.          </th>   <td>    47.4</td>  
</tr>
</tbody></table><br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</div>
</div>
<p>These four variables explain 2.6% of the stflife variance. Not a lot. This means that life satisfaction is rather formed by other predictors.</p>
</section>
<section id="how-well-can-life-satisfaction-predict-voting-behavior" class="level2">
<h2 class="anchored" data-anchor-id="how-well-can-life-satisfaction-predict-voting-behavior">How well can life satisfaction predict voting behavior?</h2>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>dfvote <span class="op">=</span> df.drop(df[df.vote <span class="op">&gt;</span> <span class="dv">2</span>].index)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>dfvote.vote.replace(to_replace<span class="op">=</span>[<span class="dv">2</span>], value <span class="op">=</span> <span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>dfvote <span class="op">=</span> dfvote[dfvote[<span class="st">'stflife'</span>].notna()]</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>dfvote <span class="op">=</span> sm.add_constant(dfvote)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> sm.Logit(dfvote[<span class="st">'vote'</span>], dfvote[[<span class="st">'stflife'</span>, <span class="st">'const'</span>]]).fit(method<span class="op">=</span><span class="st">'bfgs'</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(results.summary())</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">#slope = 0.1141 </span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">#intercept =  0.4745</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>dfvoteplot <span class="op">=</span> dfvote[[<span class="st">'stflife'</span>, <span class="st">'const'</span>]]</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>dfvoteplot[<span class="st">'stflifexslope'</span>] <span class="op">=</span> dfvoteplot[<span class="st">'stflife'</span>]<span class="op">*</span><span class="fl">0.1141</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>dfvoteplot[<span class="st">'const'</span>] <span class="op">=</span> <span class="fl">0.4745</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>dfvoteplot[<span class="st">'x'</span>] <span class="op">=</span> dfvoteplot[<span class="st">'stflifexslope'</span>] <span class="op">+</span> dfvoteplot[<span class="st">'const'</span>]</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>dfvoteplot[<span class="st">'y'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>dfvoteplot[<span class="st">'y'</span>] <span class="op">=</span> dfvoteplot[<span class="st">'x'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: np.exp(x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>np.exp(x)))</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x <span class="op">=</span> dfvoteplot[<span class="st">'stflife'</span>], y <span class="op">=</span> dfvoteplot[<span class="st">'y'</span>])</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.534224
         Iterations: 10
         Function evaluations: 16
         Gradient evaluations: 16</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                           Logit Regression Results                           
==============================================================================
Dep. Variable:                   vote   No. Observations:               135141
Model:                          Logit   Df Residuals:                   135139
Method:                           MLE   Df Model:                            1
Date:                Wed, 18 Jan 2023   Pseudo R-squ.:               0.0003439
Time:                        23:23:08   Log-Likelihood:                -72196.
converged:                       True   LL-Null:                       -72220.
Covariance Type:            nonrobust   LLR p-value:                 1.815e-12
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
stflife        0.0082      0.001      6.615      0.000       0.006       0.011
const          1.1720      0.011    106.980      0.000       1.151       1.193
==============================================================================</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\User\AppData\Local\Temp\ipykernel_2388\3900165891.py:11: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dfvoteplot['stflifexslope'] = dfvoteplot['stflife']*0.1141
C:\Users\User\AppData\Local\Temp\ipykernel_2388\3900165891.py:12: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dfvoteplot['const'] = 0.4745
C:\Users\User\AppData\Local\Temp\ipykernel_2388\3900165891.py:13: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dfvoteplot['x'] = dfvoteplot['stflifexslope'] + dfvoteplot['const']
C:\Users\User\AppData\Local\Temp\ipykernel_2388\3900165891.py:14: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dfvoteplot['y'] = 0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\User\AppData\Local\Temp\ipykernel_2388\3900165891.py:15: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dfvoteplot['y'] = dfvoteplot['x'].apply(lambda x: np.exp(x)/(1+np.exp(x)))</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ESS-analysis_files/figure-html/cell-12-output-5.png" width="597" height="429"></p>
</div>
</div>
<p>This plot shows that the greater stflife is, the greater voting probability appears. However, pseudo R-squ. is extremely low, so we should better look for other predictors. The relation of the independent and the dependent value we discovered may be a coincidence (despite the p value being 0). Another dissatisfying aspect is that the any stflife level that leads to voting result is 0 (if stflife == 0, probability = 0.61644, so the person is always more likely to vote than not to vote). In such a way, the model is not useful.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>ct1 <span class="op">=</span> pd.crosstab(index <span class="op">=</span> dfvote[<span class="st">'vote'</span>], columns <span class="op">=</span> dfvote[<span class="st">'stflife'</span>]).reset_index().drop(<span class="st">'vote'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>ct2 <span class="op">=</span> ct1.transpose().reset_index().melt(id_vars<span class="op">=</span>[<span class="st">'stflife'</span>])</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>ct2 <span class="op">=</span> ct2.rename(columns<span class="op">=</span>{<span class="st">'value'</span>: <span class="st">'Number of observations'</span>, <span class="st">'variable'</span> : <span class="st">'Voter (1) or not (0)'</span>})</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.barplot(data <span class="op">=</span> ct2, x<span class="op">=</span>ct2[<span class="st">'stflife'</span>], y <span class="op">=</span> ct2[<span class="st">'Number of observations'</span>], hue <span class="op">=</span> <span class="st">'Voter (1) or not (0)'</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="ESS-analysis_files/figure-html/cell-13-output-1.png" width="610" height="429"></p>
</div>
</div>
<p>The barplot where we may observe: the number of voters is indeed larger for any stflife value, but non-voters also exist in each category. This prooves the fit performed above was not realistic.</p>
</section>
<section id="how-can-we-improve-the-prediction-of-voters" class="level2">
<h2 class="anchored" data-anchor-id="how-can-we-improve-the-prediction-of-voters">How can we improve the prediction of voters?</h2>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>dfvoteqn <span class="op">=</span> df[[<span class="st">'stflife'</span>, <span class="st">'polintr'</span>,<span class="st">'euftf'</span>, <span class="st">'trstplc'</span>, <span class="st">'imueclt'</span>, <span class="st">'atchctr'</span>, <span class="st">'vote'</span>]]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>dfvoteqn <span class="op">=</span> sm.add_constant(dfvoteqn)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>dfvoteqn.euftf.replace(to_replace<span class="op">=</span>[<span class="dv">77</span>, <span class="dv">88</span>, <span class="dv">99</span>], value <span class="op">=</span> <span class="va">None</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>dfvoteqn.atchctr.replace(to_replace<span class="op">=</span>[<span class="st">''</span>,<span class="st">'77'</span>, <span class="st">'88'</span>, <span class="st">'99'</span>], value <span class="op">=</span> <span class="va">None</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>dfvoteqn.trstplc.replace(to_replace<span class="op">=</span>[<span class="dv">77</span>, <span class="dv">88</span>, <span class="dv">99</span>], value <span class="op">=</span> <span class="va">None</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>dfvoteqn.imueclt.replace(to_replace<span class="op">=</span>[<span class="dv">77</span>, <span class="dv">88</span>, <span class="dv">99</span>], value <span class="op">=</span> <span class="va">None</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>dfvoteqn <span class="op">=</span> dfvoteqn[dfvoteqn[<span class="st">'polintr'</span>]<span class="op">&lt;</span><span class="dv">7</span>]</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>dfvoteqn<span class="op">=</span> dfvoteqn[dfvoteqn[<span class="st">'vote'</span>] <span class="op">&lt;=</span> <span class="dv">2</span>]</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>dfvoteqn[<span class="st">'vote'</span>].replace(to_replace<span class="op">=</span>[<span class="dv">2</span>], value <span class="op">=</span> <span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>dfvoteqn <span class="op">=</span> dfvoteqn.dropna()</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(dfvoteqn[[<span class="st">'stflife'</span>, <span class="st">'polintr'</span>,<span class="st">'euftf'</span>, <span class="st">'trstplc'</span>, <span class="st">'imueclt'</span>, <span class="st">'atchctr'</span>, <span class="st">'const'</span>]], dfvoteqn[<span class="st">'vote'</span>], test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">228</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> sm.Logit(y_train, X_train[[<span class="st">'stflife'</span>, <span class="st">'polintr'</span>,<span class="st">'euftf'</span>, <span class="st">'trstplc'</span>, <span class="st">'imueclt'</span>, <span class="st">'atchctr'</span>, <span class="st">'const'</span>]].astype(<span class="bu">float</span>)).fit(method<span class="op">=</span><span class="st">'bfgs'</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(results.summary())</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> (confusion_matrix,           accuracy_score)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> X_test[[<span class="st">'stflife'</span>, <span class="st">'polintr'</span>,<span class="st">'euftf'</span>, <span class="st">'trstplc'</span>, <span class="st">'imueclt'</span>, <span class="st">'atchctr'</span>, <span class="st">'const'</span>]].astype(<span class="bu">int</span>)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>yhat <span class="op">=</span> results.predict(X_test[[<span class="st">'stflife'</span>, <span class="st">'polintr'</span>,<span class="st">'euftf'</span>, <span class="st">'trstplc'</span>, <span class="st">'imueclt'</span>, <span class="st">'atchctr'</span>, <span class="st">'const'</span>]])</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>prediction <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">round</span>, yhat))</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> confusion_matrix(y_test, prediction) </span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="st">"Confusion Matrix : </span><span class="ch">\n</span><span class="st">"</span>, cm) </span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test accuracy = '</span>, accuracy_score(y_test, prediction))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.474242
         Iterations: 21
         Function evaluations: 25
         Gradient evaluations: 25</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                           Logit Regression Results                           
==============================================================================
Dep. Variable:                   vote   No. Observations:                93969
Model:                          Logit   Df Residuals:                    93962
Method:                           MLE   Df Model:                            6
Date:                Wed, 18 Jan 2023   Pseudo R-squ.:                 0.08085
Time:                        23:23:17   Log-Likelihood:                -44564.
converged:                       True   LL-Null:                       -48484.
Covariance Type:            nonrobust   LLR p-value:                     0.000
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
stflife        0.0092      0.002      4.805      0.000       0.005       0.013
polintr       -0.7609      0.010    -75.240      0.000      -0.781      -0.741
euftf          0.0003      0.003      0.097      0.923      -0.006       0.007
trstplc        0.0791      0.003     24.637      0.000       0.073       0.085
imueclt        0.0024      0.003      0.688      0.491      -0.004       0.009
atchctr       -0.0008      0.000     -4.200      0.000      -0.001      -0.000
const          2.9111      0.046     62.631      0.000       2.820       3.002
==============================================================================
Confusion Matrix : 
 [[  281  4571]
 [  288 18353]]
Test accuracy =  0.7931724343421445</code></pre>
</div>
</div>
<p>The model now splits 80% of people into voters and non-voters correctly. However, the false positive rate remains relatively high (if we compare it to false negative), which means that the model considers people to be more eager to vote than they actually are.</p>
</section>
<section id="how-do-country-variables-change-the-predictionwith-statsmodels" class="level2">
<h2 class="anchored" data-anchor-id="how-do-country-variables-change-the-predictionwith-statsmodels">How do country variables change the prediction?(with statsmodels)</h2>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>dfvote <span class="op">=</span> pd.concat([dfvote[[<span class="st">'stflife'</span>, <span class="st">'const'</span>]], pd.get_dummies(dfvote.cntry, drop_first<span class="op">=</span><span class="va">True</span>), dfvote[<span class="st">'vote'</span>]], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(dfvote.iloc[:, <span class="dv">0</span>:<span class="dv">31</span>], dfvote[<span class="st">'vote'</span>], test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">228</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>resultssm <span class="op">=</span> sm.Logit(y_train, X_train).fit(method<span class="op">=</span><span class="st">'bfgs'</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(resultssm.summary())</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">#slope = 0.0851</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co">#intercept =  0.6967</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co">#+dumies</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>yhat <span class="op">=</span> resultssm.predict(X_test)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>prediction <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">round</span>, yhat))</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> confusion_matrix(y_test, prediction) </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="st">"Confusion Matrix : </span><span class="ch">\n</span><span class="st">"</span>, cm) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.514213
         Iterations: 35
         Function evaluations: 41
         Gradient evaluations: 41</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\User\AppData\Local\Programs\Python\Python310\lib\site-packages\statsmodels\base\model.py:604: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  warnings.warn("Maximum Likelihood optimization failed to "</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                           Logit Regression Results                           
==============================================================================
Dep. Variable:                   vote   No. Observations:               108112
Model:                          Logit   Df Residuals:                   108081
Method:                           MLE   Df Model:                           30
Date:                Wed, 18 Jan 2023   Pseudo R-squ.:                 0.03668
Time:                        23:23:21   Log-Likelihood:                -55593.
converged:                      False   LL-Null:                       -57709.
Covariance Type:            nonrobust   LLR p-value:                     0.000
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
stflife        0.0023      0.001      1.977      0.048    1.96e-05       0.005
const          1.2146      0.024     49.793      0.000       1.167       1.262
AT             0.4761      0.052      9.221      0.000       0.375       0.577
BE             1.0427      0.060     17.243      0.000       0.924       1.161
BG            -0.1236      0.042     -2.972      0.003      -0.205      -0.042
CH            -0.5826      0.045    -13.072      0.000      -0.670      -0.495
CY             0.3507      0.062      5.681      0.000       0.230       0.472
CZ            -0.6404      0.043    -14.900      0.000      -0.725      -0.556
DE             0.3571      0.042      8.597      0.000       0.276       0.438
DK             1.4736      0.073     20.074      0.000       1.330       1.617
EE            -0.5910      0.040    -14.605      0.000      -0.670      -0.512
ES             0.0092      0.045      0.206      0.837      -0.078       0.097
FI             0.4677      0.048      9.681      0.000       0.373       0.562
FR            -0.1543      0.042     -3.642      0.000      -0.237      -0.071
GB            -0.2054      0.039     -5.266      0.000      -0.282      -0.129
HR            -0.3726      0.064     -5.861      0.000      -0.497      -0.248
HU            -0.1513      0.044     -3.473      0.001      -0.237      -0.066
IE            -0.0129      0.041     -0.313      0.754      -0.094       0.068
IL            -0.0084      0.061     -0.138      0.890      -0.128       0.111
IS             0.6654      0.090      7.405      0.000       0.489       0.842
IT             0.1001      0.052      1.914      0.056      -0.002       0.203
LT            -0.7042      0.044    -15.955      0.000      -0.791      -0.618
LV            -0.2012      0.093     -2.165      0.030      -0.383      -0.019
ME             0.3814      0.093      4.112      0.000       0.200       0.563
NL             0.3447      0.048      7.234      0.000       0.251       0.438
NO             0.7308      0.057     12.846      0.000       0.619       0.842
PL            -0.4439      0.042    -10.581      0.000      -0.526      -0.362
PT            -0.2205      0.042     -5.210      0.000      -0.303      -0.138
RS            -0.3292      0.050     -6.596      0.000      -0.427      -0.231
RU            -0.5261      0.042    -12.573      0.000      -0.608      -0.444
SE             1.1734      0.062     18.853      0.000       1.051       1.295
==============================================================================
Confusion Matrix : 
 [[    0  6163]
 [    0 20866]]</code></pre>
</div>
</div>
<p>The results do not differ from the simplest one that much, but at least the model can now predict non-voters (however, just a tiny proportion of them). This means that country explains a valid part of variance of voting probability though the proportion of additionally explained variance does not permit to fit a model with over 80 accuracy.</p>
</section>
<section id="how-do-country-variables-change-the-predictionwith-sklearn" class="level2">
<h2 class="anchored" data-anchor-id="how-do-country-variables-change-the-predictionwith-sklearn">How do country variables change the prediction?(with sklearn)</h2>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> metrics</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> LogisticRegression(solver <span class="op">=</span> <span class="st">'saga'</span>).fit(X_train, y_train)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(results.coef_)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>y_hat <span class="op">=</span> results.predict(X_test)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(results.score(X_test, y_test))</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> metrics.confusion_matrix(y_test, y_hat) </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="st">"Confusion Matrix : </span><span class="ch">\n</span><span class="st">"</span>, cm)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co">#slope = 0.0814</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co">#intercept =  0.1333</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co">#+dummies</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 0.00217827  0.58294688  0.52210117  1.04024339 -0.10558215 -0.55274485
   0.3765486  -0.61237753  0.37594006  1.46982512 -0.50959754  0.06401073
   0.53500049 -0.1171037  -0.13071605 -0.31249016 -0.11059965  0.0212928
   0.03866566  0.82899286  0.15432661 -0.68179001 -0.24271105  0.5076939
   0.41180948  0.74549419 -0.40138967 -0.18699142 -0.25336814 -0.49183307
   1.16214986]]
0.7719856450479115
Confusion Matrix : 
 [[    0  6163]
 [    0 20866]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\User\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\linear_model\_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(</code></pre>
</div>
</div>
<p>The model by sklearn performs exactly like the model without country dummies (found it by chance). Allegedly it is due to the method used: statsmodels fitting performs the same not only without country dummies, but also if the method is changed to ‘newton’, for example. Unfortunately, no solver (equivalent of method) type from sklearn permits to tune the model in the same way.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>coefdf <span class="op">=</span> pd.DataFrame({<span class="st">'var_name'</span>: dfvote.columns[<span class="dv">0</span>:<span class="dv">31</span>],<span class="st">'skl'</span>:results.coef_[<span class="dv">0</span>], <span class="st">'stm'</span>: resultssm.params.reset_index()[<span class="dv">0</span>]})</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.subplots()</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.barplot(y<span class="op">=</span>coefdf.var_name, x<span class="op">=</span>coefdf.skl, color<span class="op">=</span><span class="st">'b'</span>, orient <span class="op">=</span> <span class="st">'h'</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.barplot(y<span class="op">=</span>coefdf.var_name, x<span class="op">=</span>coefdf.stm, color<span class="op">=</span><span class="st">'r'</span>, orient <span class="op">=</span> <span class="st">'h'</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">"Coefficients: Statsmodels - red, Sklearn - blue"</span>, ylabel<span class="op">=</span><span class="st">"Predictors"</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="ESS-analysis_files/figure-html/cell-17-output-1.png" width="605" height="429"></p>
</div>
</div>
<p>Most of the coefficients do not vary greatly, but some of them even have different signs. Thus models that are very alike and differ only by method treat some countries as increasing or decreasing voting probability in opposite way.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>